<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>

<body>
    <!-- 艺术背景 -->
    <div class="visual-background">
        <div class="blob pink"></div>
        <div class="blob blue"></div>
        <div class="blob green"></div>
        <div class="glass-overlay"></div>
    </div>

    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="container nav-inner">
            <a href="{{ '/' | relative_url }}" class="logo">Yiming Guo<span>.</span></a>
            <div class="nav-links">
                <a href="{{ '/' | relative_url }}" data-i18n="nav.home">Works</a>
                <a href="#about" data-i18n="nav.about">About</a>
                <a href="{{ site.cv_url }}" target="_blank" data-i18n="nav.cv">Resume</a>
            </div>
            <div class="lang-switch">
                <button type="button" data-lang-btn="en">EN</button>
                <button type="button" data-lang-btn="cn">CN</button>
            </div>
        </div>
    </nav>

    <main>{{ content }}</main>

    <footer>
        <div class="container">
            <p data-i18n="footer">&copy; {{ site.time | date: '%Y' }} {{ site.title }}. Built with Jekyll.</p>
            <div style="margin-top: 15px; font-size: 1.2rem;">
                <a href="mailto:{{ site.email }}"><i class="fas fa-envelope"></i></a>
                <a href="{{ site.github_url }}"><i class="fab fa-github"></i></a>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 1. 语言切换逻辑
            const rawData = '{{ site.data.i18n | jsonify }}';
            const dict = JSON.parse(rawData) || {};
            const langButtons = document.querySelectorAll('[data-lang-btn]');
            const transEls = document.querySelectorAll('[data-i18n]');

            const applyLang = (lang) => {
                const isCn = lang === 'cn';
                document.documentElement.lang = isCn ? 'zh' : 'en';
                localStorage.setItem('lang', lang);

                langButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.langBtn === lang));

                transEls.forEach(el => {
                    const path = el.dataset.i18n;
                    const text = path.split('.').reduce((o, k) => o?.[k], dict[lang]);
                    if (text) el.innerHTML = text;
                });
            };

            const savedLang = localStorage.getItem('lang') || 'en';
            applyLang(savedLang);
            langButtons.forEach(btn => btn.addEventListener('click', () => applyLang(btn.dataset.langBtn)));

            // 2. 艺术背景视差效果
            document.addEventListener('mousemove', (e) => {
                const x = (e.clientX / window.innerWidth - 0.5) * 40;
                const y = (e.clientY / window.innerHeight - 0.5) * 40;
                gsap.to(".pink", { x: x, y: y, duration: 2, ease: "power2.out" });
                gsap.to(".blue", { x: -x, y: -y, duration: 2.5, ease: "power2.out" });
                gsap.to(".green", { x: x * 0.5, y: -y * 0.8, duration: 3, ease: "power2.out" });
            });

            // --- 4. 入场动画 ---
            gsap.registerPlugin(ScrollTrigger);
            gsap.from("main", { opacity: 0, y: 30, duration: 1, ease: "power2.out" });

            document.querySelectorAll(".reveal").forEach(el => {
                gsap.from(el, {
                    opacity: 0, y: 30, duration: 0.8,
                    scrollTrigger: { trigger: el, start: "top 85%" }
                });
            });
        });
    </script>
    <script src="{{ '/assets/js/grid-glow.js' | relative_url }}"></script>
</body>

</html>